<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="Carl James M. Ayag" />
  <meta name="description" content="View your sadness survey results and track patterns in your emotional well-being over time to better understand and manage feelings of sadness" />
  <meta name="keywords" content="HTML, CSS, JavaScript, sadness, depression, survey results, mental health, emotional tracking" />
  <title>Sad Survey Results â€“ Psyche Portfolio</title>
  <link rel="icon" type="image/png" sizes="16x16,32x32" href="images/favicon_io/favicon-32x32.png" />
  <link rel="manifest" href="images/favicon_io/site.webmanifest" />
  <link rel="stylesheet" href="styles/styles.css" media="all" />
  <link rel="stylesheet" href="styles/sad-style.css" media="all" />
</head>
<body class="sad-theme">
  <nav id="navigation" role="navigation" aria-label="Primary">
    <ul>
      <li>
        <a href="index.html">ğŸ Home</a> |
        <a href="survey.html">ğŸ“œSurveys</a> |
        <a href="results.html">ğŸ“ˆResults</a> |
        <a href="index.html#about-us-header">ğŸ“About</a> |
        <a href="contact.html">ğŸ“Contact</a> |
        <a href="media-graphic.html">ğŸ¨Media</a> |
        <a href="Faq.html">â“FAQ</a>
      </li>
    </ul>
  </nav>

  <div class="container">
    <h2>Sad Survey Results ğŸ˜¢</h2>
    <p class="subtitle">Your responses have been recorded. Here's a summary of your sad emotion survey data.</p>

    <!-- Survey Data Display -->
    <div class="results-section">
      <h3>Your Latest Sad Survey Response</h3>
      <div class="result-card" id="latestResponse">
        <p><strong>Loading your latest response...</strong></p>
      </div>
    </div>

    <!-- Survey History -->
    <div class="results-section">
      <h3>Your Sad Survey History</h3>
      <div class="results-grid" id="surveyHistory">
        <p>Loading survey history...</p>
      </div>
    </div>

    <!-- Insights Section -->
    <div class="results-section">
      <h3>Personal Insights</h3>
      <div class="insights-card" id="insights">
        <p>Complete more surveys to see personalized insights here.</p>
      </div>
    </div>

    <!-- Navigation -->
    <div class="emotion-nav">
      <a href="sad.html"><button class="emotion-btn happy-btn">â† Back to Sad Page</button></a>
      <a href="results.html"><button class="btn">View All Results</button></a>
    </div>
  </div>

  <script>
    function displaySadResults() {
      try {
        const sadData = JSON.parse(localStorage.getItem('sadSurveys') || '[]');

        if (sadData.length === 0) {
          document.getElementById('latestResponse').innerHTML = '<p>No survey responses found. Take the sad survey first!</p>';
          document.getElementById('surveyHistory').innerHTML = '<p>No survey history available.</p>';
          return;
        }

        // Display latest response
        const latest = sadData[sadData.length - 1];
        const latestDate = new Date(latest.timestamp).toLocaleString();

        document.getElementById('latestResponse').innerHTML = `
          <h4>Latest Response - ${latestDate}</h4>
          <p><strong>Sadness Level:</strong> ${latest.sadnessLevel}/10</p>
          <p><strong>Lost Joy Activities:</strong> ${latest.lostJoy || 'Not specified'}</p>
          <p><strong>Hopelessness Frequency:</strong> ${latest.hopelessness || 'Not specified'}</p>
        `;

        // Display survey history
        const historyContainer = document.getElementById('surveyHistory');
        historyContainer.innerHTML = '';

        // Show last 5 responses
        const recentResponses = sadData.slice(-5).reverse();

        recentResponses.forEach((response, index) => {
          const responseDate = new Date(response.timestamp).toLocaleString();
          const card = document.createElement('div');
          card.className = 'result-card';
          card.innerHTML = `
            <h5>Response #${sadData.length - index} - ${responseDate}</h5>
            <p><strong>Sadness Level:</strong> ${response.sadnessLevel}/10</p>
            <p><strong>Lost Joy:</strong> ${response.lostJoy || 'Not specified'}</p>
            <p><strong>Hopelessness:</strong> ${response.hopelessness || 'Not specified'}</p>
          `;
          historyContainer.appendChild(card);
        });

        // Generate insights
        generateInsights(sadData);

      } catch (err) {
        console.error('Error loading sad survey data:', err);
        document.getElementById('latestResponse').innerHTML = '<p>Error loading survey data.</p>';
      }
    }

    function generateInsights(data) {
      if (data.length < 2) {
        document.getElementById('insights').innerHTML = '<p>Complete more surveys to see insights about your emotional patterns.</p>';
        return;
      }

      const insights = [];
      const avgSadness = data.reduce((sum, d) => sum + d.sadnessLevel, 0) / data.length;

      insights.push(`Average sadness level: ${avgSadness.toFixed(1)}/10`);

      const highSadnessDays = data.filter(d => d.sadnessLevel >= 7).length;
      if (highSadnessDays > 0) {
        insights.push(`${highSadnessDays} days with high sadness levels (7+)`);
      }

      const commonHopelessness = data
        .map(d => d.hopelessness)
        .filter(Boolean)
        .reduce((acc, val) => {
          acc[val] = (acc[val] || 0) + 1;
          return acc;
        }, {});

      if (Object.keys(commonHopelessness).length > 0) {
        const mostCommon = Object.entries(commonHopelessness).sort(([,a], [,b]) => b - a)[0];
        insights.push(`Most common hopelessness frequency: ${mostCommon[0]} (${mostCommon[1]} times)`);
      }

      document.getElementById('insights').innerHTML = `
        <h4>Your Sadness Patterns</h4>
        <ul>
          ${insights.map(insight => `<li>${insight}</li>`).join('')}
        </ul>
        <p><em>These insights are based on your survey responses. Consider discussing patterns with a mental health professional.</em></p>
      `;
    }

    // Load results on page load
    document.addEventListener('DOMContentLoaded', displaySadResults);
  </script>

  <!-- Footer Section -->
  <div id="footer" role="contentinfo">
    <p>&#169; 2025 Psyche Analyst Website. All Rights Reserved.</p>
    <p>Author: Carl James M. Ayag</p>
    <p><a href="mailto:cjayag80@gmail.com">cjayag80@gmail.com</a></p>
  </div>
</body>
</html>
